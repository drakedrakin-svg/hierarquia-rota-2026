<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Hierarquia ROTA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
/* --- ESTILO ORIGINAL (N츾O REMOVIDO) --- */
body { font-family:'Arial',sans-serif; background:#181c23; color:#f1f1f1; margin:0; padding:0; min-height:100vh; }
header { text-align:center; padding:30px 20px 10px 20px; background:#23273a; border-bottom:4px solid #FFD700; box-shadow:0 4px 16px #0008; }
header img { height:90px; filter:drop-shadow(0 0 16px #FFD70088); margin-bottom:10px; }
header h1 { margin:10px 0 0 0; font-size:2.2em; color:#FFD700; letter-spacing:3px; font-family:'Bebas Neue',Arial,sans-serif; text-shadow:0 2px 8px #000,0 0 10px #FFD70055; }
.container { max-width:900px; margin:30px auto; padding:20px; min-height:400px; }
.categoria { margin:22px 0; padding:18px; border-radius:12px; box-shadow:0 2px 12px #0006; position:relative; border-left:6px solid transparent; background:#23273a; }
.categoria h2 { margin:0 0 14px 0; font-size:24px; font-family:'Bebas Neue',Arial,sans-serif; border-bottom:2px solid #FFD70033; letter-spacing:.5px; display:flex; align-items:center; gap:10px; }
.militar-list { list-style:none; padding:0; margin:0; }
.militar { padding:8px 16px; margin:6px 0; border-radius:7px; font-size:18px; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.04); box-shadow:0 1px 6px #0003 inset; transition:all .3s;}
.militar.highlight { animation: highlightAnim .7s;}
@keyframes highlightAnim { 0% { background:#FFD70033; transform:scale(1.02);} 50%{background:#FFD70055;} 100%{background:rgba(255,255,255,0.04); transform:scale(1);} }
.militar .remover-btn { background:#ff4444; color:#fff; border:none; border-radius:5px; padding:3px 10px; margin-left:10px; cursor:pointer; font-size:.95em; transition:.2s;}
.militar .remover-btn:hover { background:#ff0000;}
.Tenente-Coronel { background:linear-gradient(90deg,#FFD700cc,#fffbe6cc); color:#222; border-left-color:#FFD700;}
.Major { background:linear-gradient(90deg,#C0C0C0cc,#eaeaea99); color:#222; border-left-color:#C0C0C0;}
.Capit칚o { background:linear-gradient(90deg,#00008Bcc,#1e3c72cc); color:#fff; border-left-color:#00008B;}
.Tenente { background:linear-gradient(90deg,#006400cc,#43a047cc); color:#fff; border-left-color:#43a047;}
.Sargento { background:linear-gradient(90deg,#654321cc,#b8860bcc); color:#fff; border-left-color:#b8860b;}
.Soldado { background:linear-gradient(90deg,#555555cc,#888888cc); color:#fff; border-left-color:#888888;}
.Estagi치rio { background:linear-gradient(90deg,#fff,#eaeaea); color:#222; border-left-color:#bbb;}
#adminBtn { position:fixed; top:24px; right:32px; z-index:10; background:#23273a; color:#FFD700; border:none; padding:12px 28px; border-radius:8px; font-weight:bold; font-size:18px; cursor:pointer; box-shadow:0 2px 8px #0005; transition:.2s;}
#adminBtn:hover { background:#FFD700;color:#23273a;}
#adminModalBg { display:none; position:fixed; top:0; left:0;width:100vw;height:100vh;z-index:100;background:#000a;justify-content:center;align-items:center;}
#adminModal { background:#23273a;padding:32px 28px;border-radius:16px;min-width:320px;max-width:95vw;box-shadow:0 8px 32px #000a;text-align:center;position:relative;}
#adminModal h3 { color:#FFD700;font-family:'Bebas Neue',Arial,sans-serif;margin-top:-10px;}
#adminModal input[type=password], #adminModal input[type=text], #adminModal select { width:80%;padding:9px;margin-bottom:.7em;border-radius:7px;border:none;background:#181c23;color:#FFD700;font-size:17px;border-bottom:2.5px solid #FFD70055;text-align:center;}
#adminModal button {background:#FFD700;color:#23273a;font-weight:bold;padding:9px 22px;border:none;border-radius:7px;font-size:18px;margin-top:.5em;margin-bottom:.5em;cursor:pointer;}
#adminModal button:hover{background:#fffbe6;color:#000;}
#fecharModalBtn { position:absolute;top:-10px;right:-10px;background:#FFD700;color:#23273a;border-radius:50%;width:36px;height:36px;font-size:22px;border:none;font-weight:bold;cursor:pointer;padding-top:.2em;}
.admin-form-row { display:flex; gap:10px; align-items:center;margin-bottom:.7em;flex-wrap:wrap;}
@media (max-width:600px){ header h1{font-size:6vw;padding:.8em;} .container{padding:.5em;} #adminBtn{top:.7em;right:.7em;padding:.7em;} #adminModal{padding:.7em;} }
.fade-in {animation:fadex .7s;}
@keyframes fadex{from{opacity:.2;transform:translateY(30px);}to{opacity:1;transform:none;}}
/* --- MELHORIAS VISUAIS E FUNCIONAIS --- */
::-webkit-scrollbar{width:.7em;background:#232526;}::-webkit-scrollbar-thumb{background:#FFD70044;border-radius:.5em;}
#removerSugestoes li:hover{background:#FFD70033;} #removerSugestoes li.selected{background:#FFD70099;color:#232526;}
#mensagem { color:#00ff66;margin-top:.5em;font-weight:bold;}
/* Separador visual no admin */
hr.separator{border:none;border-top:1.5px solid #FFD70033;margin-top:.9em;margin-bottom:.9em;}
/* Tooltip custom */
.tooltip{position:absolute;background:#232526ee;color:#FFD700;padding:.4em .9em;border-radius:.5em;font-size:.98em;font-family:sans-serif;border-bottom:.5em solid #FFD70055;
box-shadow:0 2.5px 12px #0008;font-weight:bold;text-align:center;
z-index:9999;
pointer-events:none;
opacity:.95;
transition:.15s;
}
#buscaGlobal{width:60%;max-width:340px;padding:.6em .9em;margin-bottom:.8em;border-radius:.7em;border:none;background:#181c23;color:#FFD700;font-size:18px;border-bottom:2.5px solid #FFD70055;text-align:center;}
#buscaGlobal::placeholder{color:#FFD70077;}
.busca-limpar-btn{background:none;border:none;color:#FFD700;font-size:1.3em;margin-left:-32px;margin-top:-2.5em;padding-right:.4em;padding-left:.4em;padding-top:.1em;padding-bottom:.1em;border-radius:.5em;
cursor:pointer;}
.busca-limpar-btn:hover{background:#FFD70022;color:white;}
/* Responsividade extra */
@media (max-width:400px){
    #buscaGlobal{width:98%;}
    .container{padding:.3em;}
}
</style>
</head>
<body>
<header>
<img src="https://upload.wikimedia.org/wikipedia/commons/4/47/Bras%C3%A3oROTA.png" alt="Bras칚o ROTA">
<h1>Hierarquia ROTA</h1>
</header>

<!-- Busca Global -->
<div style="text-align:center;">
    <input id="buscaGlobal" type="text" placeholder="游댌 Buscar militar ou patente..." aria-label="Buscar militar ou patente">
    <button class="busca-limpar-btn" id="limparBuscaBtn" title="Limpar busca" style="display:none;"><i class="fa fa-times"></i></button>
</div>

<button id="adminBtn" onclick="abrirAdminModal()" title="Abrir painel administrativo (Ctrl+Shift+A)"><i class="fa-solid fa-user-gear"></i> Admin</button>
<div class="container" id="hierarquia"></div>

<!-- Modal Admin -->
<div id="adminModalBg">
<div id="adminModal">
<button id="fecharModalBtn" onclick="fecharAdminModal()" title="Fechar painel administrativo">&times;</button>

<div id="loginAdminDiv">
<h3><i class="fa-solid fa-user-shield"></i> PAINEL ADMINISTRATIVO</h3>
<p style="color:#ccc;">Acesso restrito ao administrador.</p>
<input type="password" id="senhaADM" placeholder="Digite a senha..." autocomplete="off" aria-label="Senha do administrador"><br>
<button onclick="loginADM()"><i class="fa-solid fa-lock-open"></i> Entrar</button>
<div id="loginMsg" style="color:#ff6666;margin-top:.8em;"></div>
</div>

<div id="painelADM" style="display:none;">
<h3><i class="fa-solid fa-user-gear"></i> Painel Administrativo</h3>

<form id="addForm" autocomplete="off">
<div class="admin-form-row">
<select id="cargoSelect"></select>
<input type="text" id="nomeInput" placeholder="Nome do militar" required maxlength="32" aria-label="Nome do militar">
<button type="submit" title="Adicionar militar"><i class="fa-solid fa-plus"></i> Adicionar</button>
</div>
</form>

<form id="promoverForm" autocomplete="off">
<div class="admin-form-row">
<select id="militarSelect"></select>
<select id="novoCargoSelect"></select>
<button type="submit" title="Promover/mover militar"><i class="fa-solid fa-arrow-up"></i> Promover/Mover</button>
</div>
</form>

<form id="removerForm" autocomplete="off">
<div class="admin-form-row">
<input type="text" id="removerInput" placeholder="Digite o nome do militar para remover" autocomplete="off" aria-label="Remover militar">
<button type="submit" style="background:#ff4444;color:white;" title="Remover militar"><i class="fa-solid fa-user-minus"></i> Remover</button>
</div>
<ul id="removerSugestoes" style="list-style:none;padding-left:0;margin-top:-8px;"></ul>
</form>

<hr class="separator">

<!-- Backup/Importa칞칚o/Reset -->
<div style='margin-bottom:.7em'>
    <button onclick='exportarBackup()' title='Exportar backup da hierarquia'><i class='fa fa-download'></i> Exportar Backup</button>
    <label for='importBackupInput' style='display:inline-block;margin-left:.6em;margin-right:-.4em;' title='Importar backup da hierarquia'>
        <span style='cursor:pointer;background:#FFD70022;padding:.4em .9em;border-radius:.5em;color:#FFD700;font-weight:bold;'> <i class='fa fa-upload'></i> Importar Backup </span>
        <input type='file' accept='.json' id='importBackupInput' style='display:none'>
    </label>
    <button onclick='resetarHierarquia()' style='background:#ff4444;color:white;' title='Resetar hierarquia para o padr칚o'><i class='fa fa-trash-restore'></i> Resetar Hierarquia</button>
</div>

<button onclick="logoutADM()" style="margin-top:.8em;background:#222;color:#FFD700;" title='Sair do painel admin'><i class="fa-solid fa-sign-out"></i> Sair do Painel</button>
<br><small style="color:#FFD70099;">As altera칞칫es s칚o salvas automaticamente no seu navegador.</small>
<div id="mensagem"></div>
</div>
</div>
</div>

<!-- Tooltip din칙mica -->
<div id='tooltip' class='tooltip' style='display:none'></div>

<script>
// ===================
// CONFIGURA칂츾O INICIAL
// ===================
const PATENTES = [
    { nome:'Tenente-Coronel', classe:'Tenente-Coronel', icone:'fa-crown' },
    { nome:'Major', classe:'Major', icone:'fa-star' },
    { nome:'Capit칚o', classe:'Capit칚o', icone:'fa-medal' },
    { nome:'Tenente', classe:'Tenente', icone:'fa-user-tie' },
    { nome:'Sargento', classe:'Sargento', icone:'fa-user-shield' },
    { nome:'Soldado', classe:'Soldado', icone:'fa-user' },
    { nome:'Estagi치rio', classe:'Estagi치rio', icone:'fa-user-graduate' },
];
const DADOS_PADRAO = {
    'Tenente-Coronel':['Comandante Supremo'],
    'Major':['Major Silva'],
    'Capit칚o':['Capit칚o Souza'],
    'Tenente':['Tenente Lima','Tenente Costa'],
    'Sargento':['Sargento Dias'],
    'Soldado':['Soldado Alves','Soldado Nunes'],
    'Estagi치rio':['Estagi치rio J칰nior']
};
function salvarDados(dados){ localStorage.setItem('hierarquiaMilitar',JSON.stringify(dados)); }
function carregarDados(){ let d=localStorage.getItem('hierarquiaMilitar'); return d?JSON.parse(d):JSON.parse(JSON.stringify(DADOS_PADRAO)); }

// ===================
// RENDERIZA칂츾O DA HIERARQUIA
// ===================
function renderizar(filtroBusca){
    const dados = carregarDados();
    const container = document.getElementById('hierarquia');
    container.innerHTML='';
    let total=0;
    PATENTES.forEach(pat=>{
        let lista = dados[pat.nome] || [];
        // Filtro global
        let listaFiltrada = filtroBusca ? lista.filter(n=> n.toLowerCase().includes(filtroBusca.toLowerCase()) ) : lista;
        if(filtroBusca && !pat.nome.toLowerCase().includes(filtroBusca.toLowerCase()) && listaFiltrada.length===0) return;
        let html=`<div class="categoria ${pat.classe} fade-in">
        <h2><i class="fa-solid ${pat.icone}"></i> ${pat.nome} <span style='font-size:.75em;font-weight:bold;color:${pat.classe==="Estagi치rio"?"#888":"#FFD700"};'>&nbsp;&nbsp;<i class='fa fa-users'></i> ${lista.length}</span></h2>
        <ul class="militar-list">`;
        if(listaFiltrada.length===0){html+=`<li style="opacity:.5;font-style:italic;">Nenhum militar</li>`;}
        else{
            listaFiltrada.forEach(nome=>{
                html+=`<li class="militar"><span>${nome}</span></li>`;
                total++;
            });
        }
        html+=`</ul></div>`;
        container.innerHTML+=html;
    });
    if(filtroBusca && total===0){
        container.innerHTML = `<div style='text-align:center;color:#FFD700;font-size:1.25em;margin-top:2.5em;'>Nenhum resultado encontrado.</div>`;
    }
    atualizarSelects();
}
renderizar();

// ===================
// BUSCA GLOBAL
// ===================
const buscaInput = document.getElementById('buscaGlobal');
const limparBuscaBtn = document.getElementById('limparBuscaBtn');
buscaInput.addEventListener('input',()=>{
    renderizar(buscaInput.value);
    limparBuscaBtn.style.display = buscaInput.value ? 'inline-block':'none';
});
limparBuscaBtn.onclick = ()=>{
    buscaInput.value='';
    renderizar();
    limparBuscaBtn.style.display='none';
    buscaInput.focus();
};

// ===================
// ADICIONAR MILITAR
// ===================
document.getElementById('addForm').onsubmit=function(e){
e.preventDefault();if(!isADM()) return alert("Acesso restrito ao ADM!");
let cargo=document.getElementById('cargoSelect').value;
let nome=document.getElementById('nomeInput').value.trim();
if(!nome) return alert('Digite o nome!');
let dados=carregarDados();
if(!dados[cargo]) dados[cargo]=[];
if(dados[cargo].includes(nome)) return alert('J치 existe esse nome nesse cargo!');
dados[cargo].push(nome);
salvarDados(dados);
document.getElementById('nomeInput').value='';
renderizar(buscaInput.value);
destacarMilitar(cargo,nome);
mostrarMensagem(`Militar ${nome} adicionado!`);
document.getElementById('nomeInput').focus();
}

// ===================
// PROMOVER/MOVER MILITAR
// ===================
document.getElementById('promoverForm').onsubmit=function(e){
e.preventDefault();if(!isADM()) return alert("Acesso restrito ao ADM!");
let [cargoAtual,nome]=document.getElementById('militarSelect').value.split('|');
let novoCargo=document.getElementById('novoCargoSelect').value;
if(cargoAtual===novoCargo) return alert('Selecione um cargo diferente!');
let dados=carregarDados();
dados[cargoAtual]=dados[cargoAtual].filter(n=>n!==nome);
if(!dados[novoCargo]) dados[novoCargo]=[];
dados[novoCargo].push(nome);
salvarDados(dados);
renderizar(buscaInput.value);
destacarMilitar(novoCargo,nome);
mostrarMensagem(`Militar ${nome} movido para ${novoCargo}!`);
}

// ===================
// REMOVER MILITAR
// ===================
const inputRemover=document.getElementById('removerInput');
const sugestoes=document.getElementById('removerSugestoes');
let sugestoesData=[];
inputRemover.addEventListener('input',()=>{
const busca=inputRemover.value.toLowerCase();
const dados=carregarDados();
let resultados=[];
PATENTES.forEach(pat=>(dados[pat.nome]||[]).forEach(n=>{if(n.toLowerCase().includes(busca)) resultados.push({nome:n,cargo:pat.nome});}));
sugestoes.innerHTML='';
sugestoesData=resultados;
resultados.forEach(res=>{
const li=document.createElement('li');
li.style.cursor='pointer'; li.style.padding='4px 8px'; li.style.borderRadius='5px'; li.style.background='#23273a'; li.style.marginBottom='3px';
li.textContent=`${res.nome} (${res.cargo})`;
li.addEventListener('click',()=>{inputRemover.value=`${res.nome}|${res.cargo}`; sugestoes.innerHTML=''; inputRemover.focus();});
sugestoes.appendChild(li);
});
});

document.getElementById('removerForm').onsubmit=function(e){
e.preventDefault();if(!isADM()) return alert("Acesso restrito ao ADM!");
if(!inputRemover.value.includes('|')) return alert('Selecione um militar da lista!');
let [nome,cargo]=inputRemover.value.split('|');
let dados=carregarDados();
dados[cargo]=dados[cargo].filter(n=>n!==nome);
salvarDados(dados);
inputRemover.value=''; sugestoes.innerHTML='';
renderizar(buscaInput.value);
mostrarMensagem(`Militar ${nome} removido!`);
}

// ===================
// FUN칂칏ES AUXILIARES
// ===================
function atualizarSelects(){
let cargoSel=document.getElementById('cargoSelect');
cargoSel.innerHTML=PATENTES.map(p=>`<option value="${p.nome}">${p.nome}</option>`).join('');
let militarSel=document.getElementById('militarSelect');
let dados=carregarDados();
let opcoes=[];
PATENTES.forEach(p=>(dados[p.nome]||[]).forEach(n=>{opcoes.push(`<option value="${p.nome}|${n}">${n} (${p.nome})</option>`);}));
militarSel.innerHTML=opcoes.length?opcoes.join(''):`<option>Nenhum militar</option>`;
let novoCargoSel=document.getElementById('novoCargoSelect');
novoCargoSel.innerHTML=PATENTES.map(p=>`<option value="${p.nome}">${p.nome}</option>`).join('');
}

function destacarMilitar(cargo,nome){
setTimeout(()=>{
document.querySelectorAll(`.categoria.${cargo} .militar`).forEach(el=>{
if(el.textContent===nome){el.classList.add('highlight'); setTimeout(()=>{el.classList.remove('highlight');},800);}
});
},150);
}

function mostrarMensagem(msg){
const m=document.getElementById('mensagem');
m.textContent=msg;
setTimeout(()=>{m.textContent='';},2500);
}

// ===================
// ADMINISTRA칂츾O
// ===================
const SENHA_ADM = "ROTA2026";
function isADM(){return sessionStorage.getItem("admLogado")==="sim";}
function abrirAdminModal(){
document.getElementById("adminModalBg").style.display = "flex";
if(isADM()){
document.getElementById("loginAdminDiv").style.display='none';
document.getElementById("painelADM").style.display='block';
setTimeout(()=>{document.getElementById("nomeInput").focus();},200);
}else{
document.getElementById("loginAdminDiv").style.display='block';
document.getElementById("painelADM").style.display='none';
document.getElementById("senhaADM").value='';
document.getElementById("loginMsg").innerText='';
setTimeout(()=>{document.getElementById("senhaADM").focus();},200);
}
}
function fecharAdminModal(){
document.getElementById("adminModalBg").style.display = "none";
inputRemover.value=''; sugestoes.innerHTML='';
document.getElementById("senhaADM").value='';
document.getElementById("loginMsg").innerText='';
}
function loginADM(){
let senha=document.getElementById("senhaADM").value.trim();
if(senha===SENHA_ADM){ sessionStorage.setItem("admLogado","sim"); document.getElementById("loginAdminDiv").style.display='none'; document.getElementById("painelADM").style.display='block'; renderizar(buscaInput.value);}
else{ document.getElementById("loginMsg").innerText = "Senha incorreta!"; }
}
function logoutADM(){
sessionStorage.removeItem("admLogado"); document.getElementById("painelADM").style.display='none'; document.getElementById("loginAdminDiv").style.display='block'; renderizar(buscaInput.value);
}

// Atalhos de teclado
window.addEventListener('keydown',function(e){
if(e.key==="Escape") fecharAdminModal();
if(e.ctrlKey && e.shiftKey && e.key.toLowerCase()==='a'){abrirAdminModal();}
if(e.ctrlKey && e.key.toLowerCase()==='s'){e.preventDefault(); mostrarMensagem("Tudo j치 칠 salvo automaticamente!");}
});

// ===================
// BACKUP / IMPORTA칂츾O / RESET
// ===================
function exportarBackup(){
const dados = carregarDados();
const blob = new Blob([JSON.stringify(dados,null,2)],{type:"application/json"});
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href=url;a.download=`hierarquia_rota_${new Date().toISOString().slice(0,10)}.json`;
document.body.appendChild(a); a.click(); setTimeout(()=>{a.remove();URL.revokeObjectURL(url);},500);
mostrarMensagem("Backup exportado!");
}
document.getElementById('importBackupInput').addEventListener('change',function(e){
const file = e.target.files[0];
if(!file) return;
const reader = new FileReader();
reader.onload = function(ev){
try{
const obj = JSON.parse(ev.target.result);
if(typeof obj !== 'object') throw "Formato inv치lido";
salvarDados(obj);
renderizar(buscaInput.value);
mostrarMensagem("Backup importado com sucesso!");
fecharAdminModal();
}catch(err){alert("Arquivo inv치lido!");}
};
reader.readAsText(file);
this.value='';
});
function resetarHierarquia(){
if(confirm("Tem certeza que deseja resetar a hierarquia para o padr칚o? Esta a칞칚o n칚o pode ser desfeita.")){
salvarDados(DADOS_PADRAO);
renderizar(buscaInput.value);
mostrarMensagem("Hierarquia resetada!");
fecharAdminModal();
}
}

// ===================
// TOOLTIP DIN츽MICO
// ===================
const tooltip = document.getElementById('tooltip');
document.querySelectorAll('[title]').forEach(el=>{
el.addEventListener('mouseenter',function(e){
tooltip.textContent=this.title;
tooltip.style.display='block';
const rect=this.getBoundingClientRect();
tooltip.style.left=(rect.left+rect.width/2-tooltip.offsetWidth/2)+'px';
tooltip.style.top=(rect.top-window.scrollY-tooltip.offsetHeight-12)+'px';
});
el.addEventListener('mouseleave',()=>{tooltip.style.display='none';});
});
window.addEventListener('mousemove',(e)=>{
if(tooltip.style.display==='block'){
tooltip.style.left=(e.pageX-tooltip.offsetWidth/2)+'px';
tooltip.style.top=(e.pageY-tooltip.offsetHeight-18)+'px';
}
});

// Acessibilidade extra
['cargoSelect','militarSelect','novoCargoSelect','nomeInput','removerInput'].forEach(id=>{
let el=document.getElementById(id); if(el) el.setAttribute('tabindex','0');
});
</script>
</body>
</html>
